<?php    $title = htmlspecialchars($pelicula->titulo);?>
<?php require 'templates/layout/header.phtml'; ?>

<div class="item">
    <?php if ($this->res->user && $this->res->user->role == 'admin'): ?>
        <button id="edit-button" ">Editar</button>
        <a href="<?=htmlspecialchars(BASE_URL)?>eliminarPelicula/<?= htmlspecialchars($pelicula->id)?>"><button id="delete-button">Borrar</button></a>
    <?php endif; ?>
    <div class="item-image">
        <img src="<?= htmlspecialchars(BASE_URL . '/frontend/images/' .$pelicula->path_img) ?>" alt="">
    </div>
    <div class="item-info">
        <h1> <?= htmlspecialchars($pelicula->titulo) ?> </h1>
        <h2> <?= htmlspecialchars($pelicula->director) ?> </h2>
        <h3> <?= htmlspecialchars($pelicula->anio) ?> - <?= htmlspecialchars(getGeneroNombre($generos, $pelicula->id_genero)) ?> </h3>
        <p> <?= htmlspecialchars($pelicula->descripcion) ?> </p>
    </div>
</div>


<?php if ($this->res->user && $this->res->user->role == 'admin'): ?> 
<form action="<?= BASE_URL ?>editarPelicula" method="post" id="formPelicula" enctype="multipart/form-data" class="hidden">
    <input type="text" name="titulo" id="titulo" placeholder="Título de la película..." value="<?= htmlspecialchars($pelicula->titulo) ?>" required>
    <input type="text" name="director" id="director" placeholder="Director..." value="<?= htmlspecialchars($pelicula->director) ?>" required>
    <input type="number" name="anio" id="anio" placeholder="Año..." value="<?= htmlspecialchars($pelicula->anio) ?>" required>
    <select id="input-genero" name="id_genero">
    <option value="<?= htmlspecialchars($pelicula->id_genero) ?>" selected>
        <?= htmlspecialchars(getGeneroNombre($generos, $pelicula->id_genero)) ?>
    </option>
        <?php foreach($generos as $genero): ?>
            <?php if ($genero->id == $pelicula->id_genero) continue; ?>
            <option value="<?= $genero->id?>"><?= $genero->nombre ?></option>
        <?php endforeach ?>
    </select>
    <textarea name="descripcion" id="descripcion" placeholder="Descripcion..."><?= htmlspecialchars($pelicula->descripcion) ?></textarea>
    <input type="file" name="image" id="image-to-upload">
    <input type="submit" value="Enviar" id="btnSubmit">
</form>
<?php endif; ?>

<script src="<?= BASE_URL ?>frontend/js/item.js"></script>
<?php require 'templates/layout/footer.phtml'; ?>